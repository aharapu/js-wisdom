<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="/config.js"></script>
    <script
      type="module"
      src="/examples/post-message/post-message.js"
      defer
    ></script>
  </head>
  <body>
    <h1>post message example</h1>
    <input id="message-input" type="text" />
    <button id="send-message-button">send message</button>
    <hr />
    <div>
      <!-- TODO : see how to make it work using the anchor tag -->
      <a
        href="/examples/post-message/post-message-popup.html"
        target="_blank"
        rel="opener"
        style="border: 1px solid black"
        >POP-UP Same Origin Using Anchor Tag</a
      >
      <a
        id="a-cross-org"
        href="https://js-wisdom-post-message.surge.sh"
        target="_blank"
        rel="opener"
        style="border: 1px solid black"
        >POP-UP Cross Origin Using Anchor Tag</a
      >
      <button id="btn-popup-same-origin">POP-UP Same Origin</button>
      <button id="btn-popup-cross-origin">POP-UP Cross Origin</button>
    </div>
    <hr />
    <h4>iframe</h4>
    <iframe
      id="post-msg-iframe"
      style="width: 400px; height: 250px; border: 2px solid black"
      referrerpolicy="same-origin"
    ></iframe>
    <hr />
    <h3>Last received message:</h3>
    <p id="received-msg"></p>
    <hr />
    <h3>code samples</h3>
    <div id="code-samples"></div>
    <hr />
    <h4>reference reading</h4>
    <ul>
      <li>
        https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage
      </li>
      <li>https://developer.mozilla.org/en-US/docs/Web/API/Window/open</li>
      <li>https://developer.mozilla.org/en-US/docs/Web/HTML/Link_types</li>
      <li>
        https://bluepnume.medium.com/every-known-way-to-get-references-to-windows-in-javascript-223778bede2d
      </li>
    </ul>
    <hr />
    <h4>lessons learned</h4>
    <ol>
      <li>
        <p>
          postMessage takes a second argument which is the target's url. a
          <span style="background: lightgrey">*</span> can be used as a wildcard
          but that is not recommended since your data is exposed to any site
          that decides to be the opener and link to your page. it will work
          without the second argument only if on the same domain.
        </p>
      </li>
      <li>
        <p>
          when using the anchor tag, a rel="opener" must be provided, otherwise
          the opened window will not have its window.opener be null
        </p>
      </li>
    </ol>
  </body>
</html>
